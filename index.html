<!DOCTYPE html>
<html>
<head>
    <title>Secret Chat</title>
    <script src="https://unpkg.com/peerjs@1.4.7/dist/peerjs.min.js"></script>
    <style>
        body { 
            font-family: sans-serif; 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            padding-top: 50px;
        }
        #chat-box { 
            width: 300px; 
            height: 400px; 
            border: 1px solid #ccc; 
            overflow-y: scroll; 
            padding: 10px; 
            margin-top: 20px;
            margin-bottom: 10px; 
        }
        input { 
            width: 250px; 
            padding: 5px;
            margin-bottom: 5px;
            text-align: center;
        }
        button {
            cursor: pointer;
            padding: 5px 15px;
        }
    </style>
</head>
<body>

    <h1>Secret Chat</h1>

    <p>Tomar ID: <span id="my-id" style="font-weight: bold; color: blue;">Connecting...</span></p>

    <input type="text" id="friend-id" placeholder="Bondhur ID boshao">
    <br>
    <button onclick="connectToFriend()">Connect</button>

    <div id="chat-box"></div>

    <input id="message" placeholder="Message lekho...">
    <br>
    <button onclick="sendMessage()">Send</button>

    <script>
        const peer = new Peer();
        let conn;

        // Nijer ID generate hole screen-e dekhabe
        peer.on('open', (id) => {
            document.getElementById('my-id').innerText = id;
        });

        // Keu connect korte chaile connection accept kora
        peer.on('connection', (connection) => {
            conn = connection;
            setupChat();
        });

        // Bondhur ID diye connect kora
        function connectToFriend() {
            const friendID = document.getElementById('friend-id').value;
            if (friendID) {
                conn = peer.connect(friendID);
                setupChat();
            } else {
                alert("Bondhur ID boshao!");
            }
        }

        // Chat receive korar function
        function setupChat() {
            conn.on('data', (data) => {
                const box = document.getElementById('chat-box');
                box.innerHTML += `<p style="text-align: left;"><b>Bondhu:</b> ${data}</p>`;
                box.scrollTop = box.scrollHeight;
            });
            
            conn.on('open', () => {
                alert("Connected Successfully!");
            });
        }

        // Message pathano
        function sendMessage() {
            const msgInput = document.getElementById('message');
            const msg = msgInput.value;
            
            if (conn && msg) {
                conn.send(msg);
                const box = document.getElementById('chat-box');
                box.innerHTML += `<p style="text-align: right; color: green;"><b>Ami:</b> ${msg}</p>`;
                msgInput.value = "";
                box.scrollTop = box.scrollHeight;
            } else {
                alert("Age Connect koro ba message lekho!");
            }
        }
    </script>

</body>
</html>
